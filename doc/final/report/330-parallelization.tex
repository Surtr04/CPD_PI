\subsection{Parallelization}
\todo[inline]{Describe dependencies and the adaptations required to remove them (reversing the update iteration from edges to cells)}

As explained in \cref{sec:220}, the heartbeat nature of the algorithm prevents extending parallelization beyond the scope of each core function, but both functions are able to execute their internal iterations in parallel. Yet, some dependencies exist among the elements used in these functions, and adaptations are required to allow parallelization.

\todo[inline,color=blue!40]{Use algebra here too, if the change is made in the original section.}

\computeflux has only one dependency, in the computation of the elapsed time, which is removed simply by accepting the second simplification described in \cref{sec:311}. While this simplification is assumed in the final implementations, this dependency was properly studied in early stages of this project. Since the computation of the elapsed time is based in a maximum operation, it is possible to replace this dependency with a reduction\todo[color=blue!40]{Maybe add here a footnote to explain reductions} after the computation of the fluxes, thus removing the dependency and maintaining the correctness of the program.

On the other hand, the \update function has a dependency which may not be neglected because of a simplification. As described in \cref{sec:310}, the original implementation of \update iterates over the edges. While this may favor locality after executing \computeflux (which also iterates over edges), it creates a race condition when each edges adds its own contribution to the cell's value.